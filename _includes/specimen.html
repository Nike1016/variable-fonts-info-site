{% assign params = include.params|default:include %}

{% assign total_specimen_count = total_specimen_count|default:0|plus:1 %}
{% assign specimen_id = "unique-specimen-"|append:total_specimen_count %}

{% if include.playground %}
    {% capture playground_button %}<a href='#{{specimen_id}}' class='open-playground'>Experiment with this example</a>{% endcapture %}
{% endif %}

{% assign layout = params.layout|default:"single-line" %}

{% if params.lines %}
    {% assign line_labels = site.emptyArray %}
    {% assign line_axes = site.emptyArray %}
{% comment %}
    HTML can't be indented or it will be escaped
{% endcomment %}
<figure id='{{specimen_id}}' class="specimen {{layout}}"{% if params.css %} style="{% for kv in params.css %}{{kv[0]}}:{{kv[1]}};{% endfor %}"{% endif %}>
    <ul class='lines'>
    {% for line in params.lines %}
        <li>{% include specimen.html params=line record_axes=true %}</li>
    {% endfor %}
    </ul>
    <figcaption>
        <dl class='line-axes'>
        {% assign i = 0 %}
        {% for ll in line_labels %}
            <dt>{{ll}}</dt>
            <dd>{{line_axes[i]}}</dd>
            {% assign i = i|plus:1 %}
        {% endfor %}
        </dl>
    </figcaption>
</figure>
{% else %}

    {% include _specimen-vars.html params=params %}
    
    {% if include.record_axes %}
        {% assign line_labels = line_labels|push:params.label %}
        {% assign line_axes = line_axes|push:axis_listing %}
    {% endif %}

    {% assign element = params.element|default:"figure" %}
    
{% comment %}
    HTML can't be indented or it will be escaped
{% endcomment %}
<{{element}} id='{{specimen_id}}' class='specimen {{layout}} {{params.class}} {% if params.label %}has-label{% endif %} {% if params.size == "fit" %}fit-to-width{% endif %}' {% if params.fit %}data-fit-ratio="{{params.fit}}"{% endif %}>
    <span class='rendered' style='{{specimen_css}}'>{{params.text|default:"Example"}}</span>
    {% if element == "figure" %}
        <figcaption>
    {% endif %}
    {% if params.label %}
        <label>{{ params.label }}</label>
    {% endif %}
    {% unless params.label %}
        {{axis_listing}}
    {% endunless %}
    {% if element == "figure" %}
        </figcaption>
    {% endif %}
</{{element}}>

{% endif %}